# KeepAccounts_v2.0
利用python脚本实现微信、支付宝账单的合并，并保存到excel文件实现自动记账，可查看可视化图表。

作者：	MickLife
Bilibili:	https://space.bilibili.com/38626658
欢迎分享给你的朋友，但未经作者授权禁止转载

### 前言


### 第一步 下载账单

**微信账单**    

1. 进入手机版微信，选择 “我”，进入用户中心界面，然后点击 “支付” 选项；
2. 点击 “钱包”，进入钱包界面后，点击右上角的 “账单” 按钮；
3. 点击右上角“常见问题”，点击“下载账单”->“用于个人对账”；
4. 自定义账单时间，然后点击 “下一步”；
5. 填写要导出的邮箱（微信会把账单发送到你填写的邮箱），点击 “下一步”；
6. 输入支付密码，提示申请已提交，微信官方会给你发送一条消息，里面有账单的解压码；
8. 前往你的邮箱下载得到压缩包，用解压码解压得到 .csv 格式微信账单，导出成功。

**支付宝账单**
1. 电脑浏览器中打开支付宝官网 https://www.alipay.com/
2. 点击右上角“客户服务”->“自助服务”；
3. 在“交易服务”中点击“交易记录”一项；
4. 扫码登录；
5. 选择交易时间，并选择下载 excel 格式，得到 .zip 压缩包（其实是 .csv 格式，这是一种更轻便的文本格式）；
6. 解压压缩包得到 .csv 格式的支付宝账单，导出成功。

**备注：**
商家用户请勿从商家中心导出，否则数据格式不同无法使用本程序导入账单。请按以上步骤或切换至个人版页面导出。

### 第二步 运行 KeepAccounts 程序
1. 将 KeepAccounts_v2.0.zip 解压，推荐解压至 D:\Program Files\；
2. 运行 KeepAccounts_v2.0 目录下的 KeepAccounts.exe；
3. 根据提示，依次选择微信 csv 账单、支付宝 csv 账单和账本文件（自动记账2.0_源数据.xlsx）；
4. 程序会自动将微信和支付宝账单合并到你选择的账本文件。
5. 运行成功后按任意键退出。

**备注：**
程序会将账单中大部分中性支出、收入（如提现、退款）删除。
小部分中性支出、收入会被程序识别，并在逻辑 2 标注 0，乘后金额会显示 0。
由于算法的编写由个人完成，不能做到识别所有情况，如果一些中性支出、收入没能自动识别，请手动在源数据表格中将乘后金额改为 0 即可。

### 第三步 追加其他收入和支出数据
1. 打开“自动记账2.0_源数据.xlsx”；
2. 打开“明细”sheet页，在最后一行追加其他收入和支出数据；
3. 填写时注意，“月份、乘后金额、类别标记1、类别标记2”为必填项，其他可视情况填写。
4. 追加数据后一定要保存

### 第四步 查看可视化图表
1. 打开“自动记账2.0_可视化.xlsx”前，最好不要关闭源数据表格；
2. 打开“自动记账2.0_可视化.xlsx”；（如果提示各种禁止更新的信息，请点击“允许更新、启用内容”之类的选项）
4. 选择任意数据透视表中的一个单元格，右键，点击“更新”；（如果没有更新，请在数据透视表工具-分析选项卡中点击全部刷新）
5. 查看可视化图表，退出时记得保存。

**备注：**
所有数据透视表、数据透视图中的筛选按钮均可点击，可以根据需求自定义。
